name: ‚ö° Atualiza√ß√£o NUCLEAR Feed Caucaia

on: [workflow_dispatch]

jobs:
  update:
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v4
    
    - uses: actions/setup-python@v4
      with:
        python-version: '3.10'
    
    - run: pip install beautifulsoup4 requests
    
    - name: üöÄ Executar e COMMITAR
      run: |
        # 1. Executar scraper
        python upnewscaucaia.py
        
        # 2. Verificar se gerou o arquivo
        if [ ! -f "feed_caucaia_limpo.xml" ]; then
          echo "‚ùå Arquivo n√£o foi gerado!"
          exit 1
        fi
        
        # 3. Configurar git
        git config --global user.name "GitHub Actions"
        git config --global user.email "actions@github.com"
        
        # 4. FOR√áAR commit
        git add feed_caucaia_limpo.xml
        
        # Criar mensagem com timestamp √öNICO
        MSG="UPDATE: $(date '+%s')"
        git commit -m "üîÑ $MSG" || echo "‚ö†Ô∏è Commit vazio, continuando..."
        
        # 5. FOR√áAR push
        git push || git push --force
        
        echo "‚úÖ FEED ATUALIZADO NO REPOSIT√ìRIO!"
